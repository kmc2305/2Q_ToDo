<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ã‚¢ãƒ‹ãƒ¡ToDo</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Noto+Sans+JP:wght@100..900&family=Playwrite+MX+Guides&display=swap" rel="stylesheet">

  <style>
    body {
      background-color: #f980b3;
      font-family: 'DotGothic16', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px;
      transition: background-color 0.5s ease, color 0.5s ease;
    }

    h1 {
      font-size: 36px;
      margin-bottom: 20px;
      color: white;
      font-family: 'DotGothic16', sans-serif;
    }

    .header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  margin-bottom: 20px;
}

.icon {
  width: 36px;
  height: auto;
}


    /* ç™½ã„æ å…¨ä½“ */
    .main-card {
      background-color: white;
      padding: 10px;
      border-radius: 40px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      width: 80%;
      max-width: 700px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: background-color 0.5s ease, color 0.5s ease;
    }

    #toggleMode {
  image-rendering: pixelated;
  image-rendering: crisp-edges;
}

    .input-container {
      margin-top: 15px;
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .input-container input[type="text"] {
  padding: 12px 20px;
  font-size: 18px;
  width: 250px;
  border: 1px solid #f9a3c5;
  border-radius: 12px;
  font-family: 'DotGothic16', sans-serif;
}

.input-container input[type="text"]:focus {
  outline: none;
  box-shadow: none;
}

.input-container button {
  font-family: 'DotGothic16', sans-serif;
  padding: 12px 10px;
  font-size: 18px;
  background-color: #f9a3c5;
  color: white;
  border: none;
  border-radius: 12px;
  cursor: pointer;
}
    button {
      background-color: #f7a3c7;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      color: white;
      cursor: pointer;
    }

    .detail-form {
    font-family: 'DotGothic16', sans-serif;
    display: none;
    flex-direction: column;
    gap: 15px;
    margin-bottom: 20px;
    background-color: white;
    padding: 30px;               /* â† ä½™ç™½ã‚’å¤§ããã™ã‚‹ */
    border-radius: 20px;         /* â† è§’ã‚’ä¸¸ãã™ã‚‹ */
    border: 2px solid #d97f9f;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 2;
    width: 300px;                /* â† æ¨ªå¹…ã‚’æŒ‡å®šï¼ˆãŠå¥½ã¿ã§èª¿æ•´ï¼‰ */
  }

.detail-form button {
  width: 100px;         /* â† æ¨ªå¹…ã‚’ç‹­ã‚ã‚‹ */
  align-self: center;   /* â† ä¸­å¤®ã«å¯„ã›ãŸã„ãªã‚‰ */
}


    .rating-stars {
      display: flex;
      gap: 5px;
      font-size: 24px;
      cursor: pointer;
    }

    .star {
      color: #ccc;
    }

    .star.selected {
      color: gold;
    }

    .todo-list {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .todo-item {
      background-color: white;
      border-radius: 10px;
      padding: 10px;
      width: 100%;          /* â† ã“ã“ä¿®æ­£ï¼ */
      max-width: 600px;
      margin: 5px auto;
      box-sizing: border-box;
    }



    #airDate {
  font-size: 16px;
  padding: 10px;
  width: 100%;
  box-sizing: border-box;
}

#status {
  font-size: 16px;
  padding: 10px;
  width: 100%;
  box-sizing: border-box;
}

/*ä»¥ä¸‹ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰*/

body.dark {
  background-color: #5581B3;
  color: #000000;
}

body.dark .main-card {
  background-color: #ffffff;
  color: #281d36;
}

body.dark input[type="text"],
body.dark input[type="date"],
body.dark select {
  background-color: #ffffff;
  color: rgb(0, 0, 0);
  border: 1px solid #26217b;
}

body.dark button,
body.dark .input-container button {
  background-color: #96C0FF;
  color: white;
}

body.dark .todo-item {
  background-color: #ffffff;
  border-color: #26217b;
  color: #000000;
}

body.dark .star {
  color: #777;
}

body.dark .star.selected {
  color: gold;
}



@media screen and (max-width: 600px) {

  .main-card {
    width: 100%;
    padding: 2px;
  }

  #toggleMode {
    width: 32px;
    height: auto;
    align-self: flex-start;
  }

  body.dark #toggleMode {
    width: 32px;
    height: auto;
    align-self: flex-start;
  }

  .input-container input[type="text"] {
    width: 50%;
    font-size: 10px;
    padding: 8px 12px;
  }

  .input-container button {
    width: 100%;
    font-size: 10px;
    padding: 1px;
  }

  .detail-form {
    width: 90%;
    padding: 20px;
  }

  .todo-item {
    width: 100%;
    max-width: none;
    font-size: 14px;
  }

  h1 {
    font-size: 24px;
  }

  .icon {
    width: 24px;
  }

  .rating-stars {
    font-size: 20px;
    justify-content: center;
  }

  .detail-form label {
    font-size: 14px; /* â† ãƒ©ãƒ™ãƒ«å°ã•ã */
  }

  #airDate,
  #status {
    font-size: 14px;
    padding: 8px;
  }

  .rating-stars {
    font-size: 20px; /* â† æ˜Ÿã®ã‚µã‚¤ã‚ºå°ã•ã */
    justify-content: flex-start;
  }

  .detail-form {
    width: 90%;
    max-width: 320px;
    padding: 16px;
    gap: 12px;
  }

  .detail-form button {
    font-size: 14px;
    padding: 8px 16px;
  }

  #airDate,
  #status {
    width: 100%;
    font-size: 14px;
    padding: 8px;
  }

  body.dark #toggleMode {
    width: 32px;
    height: auto;
    align-self: center;
  }
}

  </style>
</head>
<body>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <div class="header">
    <img src="pc_desktop.png" class="icon" alt="å·¦ã‚¢ã‚¤ã‚³ãƒ³">
    <h1>ã‚¢ãƒ‹ãƒ¡ToDo</h1>
    <img src="pc_desktop.png" class="icon" alt="å·¦ã‚¢ã‚¤ã‚³ãƒ³">
  </div>


  <!-- ğŸ†• ç™½ã„å›²ã¿ã®ã‚«ãƒ¼ãƒ‰ -->
  <div class="main-card">
  <div class="input-container">
    <input type="text" id="titleInput" placeholder="ã‚¿ã‚¤ãƒˆãƒ«">
    <button onclick="showDetailForm()">ï¼‹è¿½åŠ </button>
    <img id="toggleMode" src="weather_sunny.png" alt="ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿" width="48" style="cursor: pointer; margin-left: 8px;">
  </div>
</div>
  

    <div class="detail-form" id="detailForm">
      <label>æ”¾é€æ—¥</label>
      <input type="date" id="airDate">

      <label>è©•ä¾¡</label>
      <div class="rating-stars" id="ratingStars">
        <span class="star" data-value="1">â˜…</span>
        <span class="star" data-value="2">â˜…</span>
        <span class="star" data-value="3">â˜…</span>
      </div>

      <label>çŠ¶æ…‹</label>
      <select id="status">
        <option value="æœªè¦–è´">æœªè¦–è´</option>
        <option value="è¦–è´æ¸ˆ">è¦–è´æ¸ˆ</option>
      </select>

      <button onclick="addTodo()">æ±ºå®š</button>
    </div>

    <div class="todo-list" id="todoList"></div>
  </div>
  
  <script>
    let selectedRating = 0;
  
    // æ˜Ÿã®è©•ä¾¡ã‚’ã‚¯ãƒªãƒƒã‚¯ã§é¸ã¹ã‚‹ï¼‹ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¾©å…ƒ
    document.addEventListener("DOMContentLoaded", () => {
      // â­ ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®çŠ¶æ…‹ã‚’localStorageã‹ã‚‰èª­ã¿è¾¼ã¿
      if (localStorage.getItem("darkMode") === "true") {
        document.body.classList.add("dark");
        document.getElementById("toggleMode").src = "moon_lightyellow.png";
      }
  
      // æ˜Ÿã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
      const stars = document.querySelectorAll(".star");
      stars.forEach(star => {
        star.addEventListener("click", () => {
          selectedRating = parseInt(star.getAttribute("data-value"));
          stars.forEach(s => s.classList.remove("selected"));
          for (let i = 0; i < selectedRating; i++) {
            stars[i].classList.add("selected");
          }
        });
      });
  
      // ToDoèª­ã¿è¾¼ã¿
      loadTodos();
    });
  
    function showDetailForm() {
      document.getElementById("detailForm").style.display = "flex";
    }
  
    function addTodo() {
      const title = document.getElementById("titleInput").value;
      const airDate = document.getElementById("airDate").value;
      const status = document.getElementById("status").value;
  
      if (!title) {
        alert("ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
        return;
      }
  
      const container = document.createElement("div");
      container.className = "todo-item";
      container.innerHTML = `
        <strong>${title}</strong><br>
        æ”¾é€æ—¥ï¼š${airDate || 'yyyy/mm/dd'}<br>
        è©•ä¾¡ï¼š${"â˜…".repeat(selectedRating)}${"â˜†".repeat(3 - selectedRating)}<br>
        çŠ¶æ…‹ï¼š<span class="status-text">${status}</span><br>
        <button onclick="toggleStatus(this)">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ‡æ›¿</button>
        <button onclick="deleteTodo(this)">å‰Šé™¤</button>
      `;
  
      document.getElementById("todoList").appendChild(container);
      saveTodos();
  
      // å…¥åŠ›æ¬„ãƒªã‚»ãƒƒãƒˆ
      document.getElementById("detailForm").style.display = "none";
      document.getElementById("titleInput").value = "";
      document.getElementById("airDate").value = "";
      document.getElementById("status").value = "æœªè¦–è´";
      selectedRating = 0;
      document.querySelectorAll(".star").forEach(s => s.classList.remove("selected"));
    }
  
    function addTodoFromStorage(todo) {
      const container = document.createElement("div");
      container.className = "todo-item";
      container.innerHTML = `
        <strong>${todo.title}</strong><br>
        æ”¾é€æ—¥ï¼š${todo.airDate || 'yyyy/mm/dd'}<br>
        è©•ä¾¡ï¼š${"â˜…".repeat(todo.rating)}${"â˜†".repeat(3 - todo.rating)}<br>
        çŠ¶æ…‹ï¼š<span class="status-text">${todo.status}</span><br>
        <button onclick="toggleStatus(this)">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ‡æ›¿</button>
        <button onclick="deleteTodo(this)">å‰Šé™¤</button>
      `;
      document.getElementById("todoList").appendChild(container);
    }
  
    function saveTodos() {
      const todos = Array.from(document.querySelectorAll(".todo-item")).map(item => {
        return {
          title: item.querySelector("strong").innerText,
          airDate: item.innerHTML.match(/æ”¾é€æ—¥ï¼š(.+?)<br>/)?.[1] ?? '',
          rating: (item.innerHTML.match(/è©•ä¾¡ï¼š(â˜…+)(â˜†*)<br>/) || [])[1]?.length || 0,
          status: item.querySelector(".status-text")?.innerText ?? 'æœªè¦–è´'
        };
      });
      localStorage.setItem("animeTodos", JSON.stringify(todos));
    }
  
    function loadTodos() {
      const saved = localStorage.getItem("animeTodos");
      if (!saved) return;
      const todos = JSON.parse(saved);
      todos.forEach(todo => {
        addTodoFromStorage(todo);
      });
    }
  
    function toggleStatus(btn) {
      const statusSpan = btn.parentElement.querySelector(".status-text");
      statusSpan.textContent = statusSpan.textContent === "æœªè¦–è´" ? "è¦–è´æ¸ˆ" : "æœªè¦–è´";
      saveTodos();
    }
  
    function deleteTodo(btn) {
      btn.parentElement.remove();
      saveTodos();
    }
  
    function toggleDarkMode() {
      const body = document.body;
      const img = document.getElementById("toggleMode");
  
      body.classList.toggle("dark");
  
      // ã‚¢ã‚¤ã‚³ãƒ³å¤‰æ›´
      if (body.classList.contains("dark")) {
        img.src = "moon_lightyellow.png";
      } else {
        img.src = "weather_sunny.png";
      }
  
      // çŠ¶æ…‹ä¿å­˜ï¼
      localStorage.setItem("darkMode", body.classList.contains("dark"));
  
      // å¼·åˆ¶å†æç”»ï¼ˆdarkç”¨ã‚¯ãƒ©ã‚¹å†è©•ä¾¡ã•ã‚Œã‚‹ã‚ˆã†ã«ï¼‰
      document.querySelectorAll(".todo-item").forEach(item => {
        item.classList.remove("todo-item");
        void item.offsetWidth;
        item.classList.add("todo-item");
      });
    }
  
    // ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆã‚¯ãƒªãƒƒã‚¯ç™»éŒ²
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("toggleMode").addEventListener("click", toggleDarkMode);
    });
  </script>  

</body>
</html>
